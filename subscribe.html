<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1"> 
    <title> Newsletter Subscription </title>
    <link rel="stylesheet" type="text/css" href="css/subscribe.css">
  </head>
<body>
<div class ="hero">
  <h3> Subscribe to the Spotless Sweepers </h3>
  <h1> Keep up with Us!</h1>
  <p> A local cleaning business resided in Circle C. </p>
  <form name = "submit-to-google-sheet"> 
    <input type="email" name="Email" placeholder="Your email ID." required>
    <button type="submit"> <img src="send.png" width="30px"></button>
  </form>
  <span id = "msg"> </span>
  </div>
  <form name="submit-to-google-sheet">
  <input name="email" type="email" placeholder="Email" required>
  <button type="submit">Send</button>
</form>
  
 <script>
   function doGet(e) {
  var cors = CorsApp.createForCurrentScript();
  cors.setAllowedOrigins(["*"]);
  cors.setAllowedMethods(["GET", "POST", "PUT", "DELETE", "OPTIONS"]);
  cors.setAllowedHeaders(["Content-Type"]);
  cors.setMaxAgeSeconds(3600);
  return ContentService
    .createTextOutput(JSON.stringify(e.parameters))
    .setMimeType(ContentService.MimeType.JSON);
}
  </script>

<script>
  const scriptURL = 'https://script.google.com/macros/s/AKfycbwHdsENebIo2nftt_oxbk_2GeH8Kb2WZ-T9-69Cb7Epr8jotpw6FhX6uFL_jF-KCS3HFA/exec'
  const form = document.forms['submit-to-google-sheet']
  const msg  = document.getElementById("msg")

  form.addEventListener('submit', e => {
    e.preventDefault()
    fetch(scriptURL, { method: 'POST', body: new FormData(form)})
      .then(response => {msg.innerHTML = "Thank you for Subscribing!"
                        setTimeout(function(){msg.innerHTML =" "},5000) })
      .catch(error => console.error('Error!', error.message))
  })
</script>
  </body>
  </head>
